I have the project that uses Spray.io. I could not narrow down the scope of the issue to create a test case, however I could grant access to the project on github if necessary.

The problem is related to case classes and JSON serialization. If I add any field to certain case class and try to compile - it fails with the following error:

```
Error:scalac: Error: org.jetbrains.jps.incremental.scala.remote.ServerException
java.lang.NullPointerException
    at scala.tools.nsc.typechecker.NamesDefaults$class.baseFunBlock$1(NamesDefaults.scala:130)
        at scala.tools.nsc.typechecker.NamesDefaults$class.transformNamedApplication(NamesDefaults.scala:375)
        at scala.tools.nsc.Global$$anon$1.transformNamedApplication(Global.scala:463)
        at scala.tools.nsc.typechecker.NamesDefaults$class.transformNamedApplication(NamesDefaults.scala:326)
        at scala.tools.nsc.Global$$anon$1.transformNamedApplication(Global.scala:463)
        at scala.tools.nsc.typechecker.Typers$Typer.tryNamesDefaults$1(Typers.scala:3365)
        at scala.tools.nsc.typechecker.Typers$Typer.doTypedApply(Typers.scala:3434)
        at scala.tools.nsc.typechecker.Typers$Typer.tryNamesDefaults$1(Typers.scala:3420)
        at scala.tools.nsc.typechecker.Typers$Typer.doTypedApply(Typers.scala:3434)
        at scala.tools.nsc.typechecker.Typers$Typer$$anonfun$tryTypedApply$1$1.apply(Typers.scala:4475)
        at scala.tools.nsc.typechecker.Typers$Typer$$anonfun$tryTypedApply$1$1.apply(Typers.scala:4475)
        at scala.tools.nsc.typechecker.Typers$Typer.silent(Typers.scala:676)
        at scala.tools.nsc.typechecker.Typers$Typer.tryTypedApply$1(Typers.scala:4475)
        at scala.tools.nsc.typechecker.Typers$Typer.normalTypedApply$1(Typers.scala:4520)
        at scala.tools.nsc.typechecker.Typers$Typer.typedApply$1(Typers.scala:4555)
        at scala.tools.nsc.typechecker.Typers$Typer.typedInAnyMode$1(Typers.scala:5320)
        at scala.tools.nsc.typechecker.Typers$Typer.typed1(Typers.scala:5337)
        at scala.tools.nsc.typechecker.Typers$Typer.runTyper$1(Typers.scala:5373)
        at scala.tools.nsc.typechecker.Typers$Typer.scala$tools$nsc$typechecker$Typers$Typer$$typedInternal(Typers.scala:5400)
        at scala.tools.nsc.typechecker.Typers$Typer.body$2(Typers.scala:5347)
        at scala.tools.nsc.typechecker.Typers$Typer.typed(Typers.scala:5351)
        at scala.tools.nsc.typechecker.Typers$Typer.typed(Typers.scala:5440)
        at scala.tools.nsc.typechecker.Typers$Typer.computeType(Typers.scala:5531)
        at scala.tools.nsc.typechecker.Namers$Namer.assignTypeToTree(Namers.scala:879)
        at scala.tools.nsc.typechecker.Namers$Namer.valDefSig(Namers.scala:1381)
        at scala.tools.nsc.typechecker.Namers$Namer.getSig$1(Namers.scala:1532)
        at scala.tools.nsc.typechecker.Namers$Namer.typeSig(Namers.scala:1541)
        at scala.tools.nsc.typechecker.Namers$Namer$$anonfun$monoTypeCompleter$1$$anonfun$apply$1.apply$mcV$sp(Namers.scala:781)
        at scala.tools.nsc.typechecker.Namers$Namer$$anonfun$monoTypeCompleter$1$$anonfun$apply$1.apply(Namers.scala:780)
        at scala.tools.nsc.typechecker.Namers$Namer$$anonfun$monoTypeCompleter$1$$anonfun$apply$1.apply(Namers.scala:780)
        at scala.tools.nsc.typechecker.Namers$Namer.scala$tools$nsc$typechecker$Namers$Namer$$logAndValidate(Namers.scala:1568)
        at scala.tools.nsc.typechecker.Namers$Namer$$anonfun$monoTypeCompleter$1.apply(Namers.scala:780)
        at scala.tools.nsc.typechecker.Namers$Namer$$anonfun$monoTypeCompleter$1.apply(Namers.scala:772)
        at scala.tools.nsc.typechecker.Namers$$anon$1.completeImpl(Namers.scala:1684)
        at scala.tools.nsc.typechecker.Namers$LockingTypeCompleter$class.complete(Namers.scala:1692)
        at scala.tools.nsc.typechecker.Namers$$anon$1.complete(Namers.scala:1682)
        at scala.reflect.internal.Symbols$Symbol.info(Symbols.scala:1483)
        at scala.reflect.internal.Symbols$Symbol.initialize(Symbols.scala:1628)
        at scala.tools.nsc.typechecker.Typers$Typer.typed1(Typers.scala:4982)
        at scala.tools.nsc.typechecker.Typers$Typer.runTyper$1(Typers.scala:5373)
        at scala.tools.nsc.typechecker.Typers$Typer.scala$tools$nsc$typechecker$Typers$Typer$$typedInternal(Typers.scala:5400)
        at scala.tools.nsc.typechecker.Typers$Typer.body$2(Typers.scala:5347)
        at scala.tools.nsc.typechecker.Typers$Typer.typed(Typers.scala:5351)
        at scala.tools.nsc.typechecker.Typers$Typer.typedByValueExpr(Typers.scala:5429)
        at scala.tools.nsc.typechecker.Typers$Typer.scala$tools$nsc$typechecker$Typers$Typer$$typedStat$1(Typers.scala:3028)
        at scala.tools.nsc.typechecker.Typers$Typer$$anonfun$62.apply(Typers.scala:3132)
        at scala.tools.nsc.typechecker.Typers$Typer$$anonfun$62.apply(Typers.scala:3132)
        at scala.collection.immutable.List.loop$1(List.scala:173)
        at scala.collection.immutable.List.mapConserve(List.scala:189)
        at scala.tools.nsc.typechecker.Typers$Typer.typedStats(Typers.scala:3132)
        at scala.tools.nsc.typechecker.Typers$Typer.typedBlock(Typers.scala:2363)
        at scala.tools.nsc.typechecker.Typers$Typer$$anonfun$typedOutsidePatternMode$1$1.apply(Typers.scala:5295)
        at scala.tools.nsc.typechecker.Typers$Typer$$anonfun$typedOutsidePatternMode$1$1.apply(Typers.scala:5295)
        at scala.tools.nsc.typechecker.Typers$Typer.typedOutsidePatternMode$1(Typers.scala:5294)
        at scala.tools.nsc.typechecker.Typers$Typer.typedInAnyMode$1(Typers.scala:5330)
        at scala.tools.nsc.typechecker.Typers$Typer.typed1(Typers.scala:5337)
        at scala.tools.nsc.typechecker.Typers$Typer.runTyper$1(Typers.scala:5373)
        at scala.tools.nsc.typechecker.Typers$Typer.scala$tools$nsc$typechecker$Typers$Typer$$typedInternal(Typers.scala:5400)
        at scala.tools.nsc.typechecker.Typers$Typer.body$2(Typers.scala:5347)
        at scala.tools.nsc.typechecker.Typers$Typer.typed(Typers.scala:5351)
        at scala.tools.nsc.typechecker.Typers$Typer.typedArg(Typers.scala:3145)
        at scala.tools.nsc.typechecker.PatternTypers$PatternTyper$class.typedArgWithFormal$1(PatternTypers.scala:112)
        at scala.tools.nsc.typechecker.PatternTypers$PatternTyper$$anonfun$2.apply(PatternTypers.scala:115)
        at scala.tools.nsc.typechecker.PatternTypers$PatternTyper$$anonfun$2.apply(PatternTypers.scala:115)
        at scala.runtime.Tuple2Zipped$$anonfun$map$extension$1.apply(Tuple2Zipped.scala:46)
        at scala.runtime.Tuple2Zipped$$anonfun$map$extension$1.apply(Tuple2Zipped.scala:44)
        at scala.collection.immutable.List.foreach(List.scala:381)
        at scala.runtime.Tuple2Zipped$.map$extension(Tuple2Zipped.scala:44)
        at scala.tools.nsc.typechecker.PatternTypers$PatternTyper$class.typedArgsForFormals(PatternTypers.scala:115)
        at scala.tools.nsc.typechecker.Typers$Typer.typedArgsForFormals(Typers.scala:107)
        at scala.tools.nsc.typechecker.Typers$Typer.scala$tools$nsc$typechecker$Typers$Typer$$handleMonomorphicCall$1(Typers.scala:3451)
        at scala.tools.nsc.typechecker.Typers$Typer.doTypedApply(Typers.scala:3476)
        at scala.tools.nsc.typechecker.Typers$Typer.normalTypedApply$1(Typers.scala:4522)
        at scala.tools.nsc.typechecker.Typers$Typer.typedApply$1(Typers.scala:4555)
        at scala.tools.nsc.typechecker.Typers$Typer.typedInAnyMode$1(Typers.scala:5320)
        at scala.tools.nsc.typechecker.Typers$Typer.typed1(Typers.scala:5337)
        at scala.tools.nsc.typechecker.Typers$Typer.runTyper$1(Typers.scala:5373)
        at scala.tools.nsc.typechecker.Typers$Typer.scala$tools$nsc$typechecker$Typers$Typer$$typedInternal(Typers.scala:5400)
        at scala.tools.nsc.typechecker.Typers$Typer.body$2(Typers.scala:5347)
        at scala.tools.nsc.typechecker.Typers$Typer.typed(Typers.scala:5351)
        at scala.tools.nsc.typechecker.Typers$Typer.typedByValueExpr(Typers.scala:5429)
        at scala.tools.nsc.typechecker.Typers$Typer.scala$tools$nsc$typechecker$Typers$Typer$$typedStat$1(Typers.scala:3028)
        at scala.tools.nsc.typechecker.Typers$Typer$$anonfun$62.apply(Typers.scala:3132)
        at scala.tools.nsc.typechecker.Typers$Typer$$anonfun$62.apply(Typers.scala:3132)
        at scala.collection.immutable.List.loop$1(List.scala:173)
        at scala.collection.immutable.List.mapConserve(List.scala:189)
        at scala.tools.nsc.typechecker.Typers$Typer.typedStats(Typers.scala:3132)
        at scala.tools.nsc.typechecker.Typers$Typer.typedBlock(Typers.scala:2363)
        at scala.tools.nsc.typechecker.Typers$Typer$$anonfun$typedOutsidePatternMode$1$1.apply(Typers.scala:5295)
        at scala.tools.nsc.typechecker.Typers$Typer$$anonfun$typedOutsidePatternMode$1$1.apply(Typers.scala:5295)
        at scala.tools.nsc.typechecker.Typers$Typer.typedOutsidePatternMode$1(Typers.scala:5294)
        at scala.tools.nsc.typechecker.Typers$Typer.typedInAnyMode$1(Typers.scala:5330)
        at scala.tools.nsc.typechecker.Typers$Typer.typed1(Typers.scala:5337)
        at scala.tools.nsc.typechecker.Typers$Typer.runTyper$1(Typers.scala:5373)
        at scala.tools.nsc.typechecker.Typers$Typer.scala$tools$nsc$typechecker$Typers$Typer$$typedInternal(Typers.scala:5400)
        at scala.tools.nsc.typechecker.Typers$Typer.body$2(Typers.scala:5347)
        at scala.tools.nsc.typechecker.Typers$Typer.typed(Typers.scala:5351)
        at scala.tools.nsc.typechecker.Typers$Typer.typedArg(Typers.scala:3145)
        at scala.tools.nsc.typechecker.PatternTypers$PatternTyper$class.typedArgWithFormal$1(PatternTypers.scala:112)
        at scala.tools.nsc.typechecker.PatternTypers$PatternTyper$$anonfun$2.apply(PatternTypers.scala:115)
        at scala.tools.nsc.typechecker.PatternTypers$PatternTyper$$anonfun$2.apply(PatternTypers.scala:115)
        at scala.runtime.Tuple2Zipped$$anonfun$map$extension$1.apply(Tuple2Zipped.scala:46)
        at scala.runtime.Tuple2Zipped$$anonfun$map$extension$1.apply(Tuple2Zipped.scala:44)
        at scala.collection.immutable.List.foreach(List.scala:381)
        at scala.runtime.Tuple2Zipped$.map$extension(Tuple2Zipped.scala:44)
        at scala.tools.nsc.typechecker.PatternTypers$PatternTyper$class.typedArgsForFormals(PatternTypers.scala:115)
        at scala.tools.nsc.typechecker.Typers$Typer.typedArgsForFormals(Typers.scala:107)
        at scala.tools.nsc.typechecker.Typers$Typer.scala$tools$nsc$typechecker$Typers$Typer$$handleMonomorphicCall$1(Typers.scala:3451)
        at scala.tools.nsc.typechecker.Typers$Typer.doTypedApply(Typers.scala:3476)
        at scala.tools.nsc.typechecker.Typers$Typer.normalTypedApply$1(Typers.scala:4522)
        at scala.tools.nsc.typechecker.Typers$Typer.typedApply$1(Typers.scala:4555)
        at scala.tools.nsc.typechecker.Typers$Typer.typedInAnyMode$1(Typers.scala:5320)
        at scala.tools.nsc.typechecker.Typers$Typer.typed1(Typers.scala:5337)
        at scala.tools.nsc.typechecker.Typers$Typer.runTyper$1(Typers.scala:5373)
        at scala.tools.nsc.typechecker.Typers$Typer.scala$tools$nsc$typechecker$Typers$Typer$$typedInternal(Typers.scala:5400)
        at scala.tools.nsc.typechecker.Typers$Typer.body$2(Typers.scala:5347)
        at scala.tools.nsc.typechecker.Typers$Typer.typed(Typers.scala:5351)
        at scala.tools.nsc.typechecker.Typers$Typer.typedByValueExpr(Typers.scala:5429)
        at scala.tools.nsc.typechecker.Typers$Typer.scala$tools$nsc$typechecker$Typers$Typer$$typedStat$1(Typers.scala:3028)
        at scala.tools.nsc.typechecker.Typers$Typer$$anonfun$62.apply(Typers.scala:3132)
        at scala.tools.nsc.typechecker.Typers$Typer$$anonfun$62.apply(Typers.scala:3132)
        at scala.collection.immutable.List.loop$1(List.scala:173)
        at scala.collection.immutable.List.mapConserve(List.scala:189)
        at scala.tools.nsc.typechecker.Typers$Typer.typedStats(Typers.scala:3132)
        at scala.tools.nsc.typechecker.Typers$Typer.typedTemplate(Typers.scala:1903)
        at scala.tools.nsc.typechecker.Typers$Typer.typedClassDef(Typers.scala:1744)
        at scala.tools.nsc.typechecker.Typers$Typer.typedMemberDef$1(Typers.scala:5286)
        at scala.tools.nsc.typechecker.Typers$Typer.typed1(Typers.scala:5336)
        at scala.tools.nsc.typechecker.Typers$Typer.runTyper$1(Typers.scala:5373)
        at scala.tools.nsc.typechecker.Typers$Typer.scala$tools$nsc$typechecker$Typers$Typer$$typedInternal(Typers.scala:5400)
        at scala.tools.nsc.typechecker.Typers$Typer.body$2(Typers.scala:5347)
        at scala.tools.nsc.typechecker.Typers$Typer.typed(Typers.scala:5351)
        at scala.tools.nsc.typechecker.Typers$Typer.typedByValueExpr(Typers.scala:5429)
        at scala.tools.nsc.typechecker.Typers$Typer.scala$tools$nsc$typechecker$Typers$Typer$$typedStat$1(Typers.scala:3028)
        at scala.tools.nsc.typechecker.Typers$Typer$$anonfun$62.apply(Typers.scala:3132)
        at scala.tools.nsc.typechecker.Typers$Typer$$anonfun$62.apply(Typers.scala:3132)
        at scala.collection.immutable.List.loop$1(List.scala:173)
        at scala.collection.immutable.List.mapConserve(List.scala:189)
        at scala.tools.nsc.typechecker.Typers$Typer.typedStats(Typers.scala:3132)
        at scala.tools.nsc.typechecker.Typers$Typer.typedPackageDef$1(Typers.scala:4989)
        at scala.tools.nsc.typechecker.Typers$Typer.typedMemberDef$1(Typers.scala:5289)
        at scala.tools.nsc.typechecker.Typers$Typer.typed1(Typers.scala:5336)
        at scala.tools.nsc.typechecker.Typers$Typer.runTyper$1(Typers.scala:5373)
        at scala.tools.nsc.typechecker.Typers$Typer.scala$tools$nsc$typechecker$Typers$Typer$$typedInternal(Typers.scala:5400)
        at scala.tools.nsc.typechecker.Typers$Typer.body$2(Typers.scala:5347)
        at scala.tools.nsc.typechecker.Typers$Typer.typed(Typers.scala:5351)
        at scala.tools.nsc.typechecker.Typers$Typer.typed(Typers.scala:5425)
        at scala.tools.nsc.typechecker.Analyzer$typerFactory$$anon$3.apply(Analyzer.scala:102)
        at scala.tools.nsc.Global$GlobalPhase$$anonfun$applyPhase$1.apply$mcV$sp(Global.scala:441)
        at scala.tools.nsc.Global$GlobalPhase.withCurrentUnit(Global.scala:432)
        at scala.tools.nsc.Global$GlobalPhase.applyPhase(Global.scala:441)
        at scala.tools.nsc.typechecker.Analyzer$typerFactory$$anon$3$$anonfun$run$1.apply(Analyzer.scala:94)
        at scala.tools.nsc.typechecker.Analyzer$typerFactory$$anon$3$$anonfun$run$1.apply(Analyzer.scala:93)
        at scala.collection.Iterator$class.foreach(Iterator.scala:750)
        at scala.collection.AbstractIterator.foreach(Iterator.scala:1202)
        at scala.tools.nsc.typechecker.Analyzer$typerFactory$$anon$3.run(Analyzer.scala:93)
        at scala.tools.nsc.Global$Run.compileUnitsInternal(Global.scala:1500)
        at scala.tools.nsc.Global$Run.compileUnits(Global.scala:1487)
        at scala.tools.nsc.Global$Run.compileSources(Global.scala:1482)
        at scala.tools.nsc.Global$Run.compile(Global.scala:1580)
        at xsbt.CachedCompiler0.run(CompilerInterface.scala:126)
        at xsbt.CachedCompiler0.run(CompilerInterface.scala:102)
        at xsbt.CompilerInterface.run(CompilerInterface.scala:27)
        at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
        at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:57)
        at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
        at java.lang.reflect.Method.invoke(Method.java:606)
        at sbt.compiler.AnalyzingCompiler.call(AnalyzingCompiler.scala:102)
        at sbt.compiler.AnalyzingCompiler.compile(AnalyzingCompiler.scala:48)
        at sbt.compiler.AnalyzingCompiler.compile(AnalyzingCompiler.scala:41)
        at org.jetbrains.jps.incremental.scala.local.IdeaIncrementalCompiler.compile(IdeaIncrementalCompiler.scala:29)
        at org.jetbrains.jps.incremental.scala.local.LocalServer.compile(LocalServer.scala:26)
        at org.jetbrains.jps.incremental.scala.remote.Main$.make(Main.scala:62)
        at org.jetbrains.jps.incremental.scala.remote.Main$.nailMain(Main.scala:20)
        at org.jetbrains.jps.incremental.scala.remote.Main.nailMain(Main.scala)
        at sun.reflect.GeneratedMethodAccessor6.invoke(Unknown Source)
        at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
        at java.lang.reflect.Method.invoke(Method.java:606)
        at com.martiansoftware.nailgun.NGSession.run(NGSession.java:319)
```